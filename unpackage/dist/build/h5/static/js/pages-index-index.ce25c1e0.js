(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{"491e":function(e,t,a){var n=a("859f");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("46a724c1",n,!0,{sourceMap:!1,shadowMode:!1})},"6c7c":function(e,t,a){"use strict";a.r(t);var n=a("825c"),i=a("be8f");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("c33d");var s=a("f0c5"),u=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"000aec5e",null,!1,n["a"],void 0);t["default"]=u.exports},"825c":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"content"},[e.showLogin?a("div",[a("div",{staticClass:"input-box"},[a("v-uni-input",{staticClass:"uni-input",attrs:{value:e.username,placeholder:"账号"}})],1),a("div",{staticClass:"input-box"},[a("v-uni-button",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSubmit.apply(void 0,arguments)}}},[e._v("登录")])],1)]):e._e(),e.showLogin?e._e():a("ul",{staticClass:"items"},[e._l(e.items,(function(t,n){return a("li",{key:n,staticClass:"item"},[a("img",{attrs:{src:t,alt:""}}),a("v-uni-button",{on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.handleRemove(t)}}},[e._v("删除")])],1)})),a("li",{staticClass:"item btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleUpload.apply(void 0,arguments)}}},[e._v("+")])],2)])},i=[]},"859f":function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,"ul[data-v-000aec5e]{padding:0;list-style-type:none}img[data-v-000aec5e]{width:100%;display:block}.items[data-v-000aec5e]{display:flex;flex-wrap:wrap}.item[data-v-000aec5e]{width:100px;height:100px}.btn[data-v-000aec5e]{cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:30px;border:2px dashed #ccc;box-sizing:border-box}.input-box[data-v-000aec5e]{padding:10px;border:1px solid #ccc}",""]),e.exports=t},be8f:function(e,t,a){"use strict";a.r(t);var n=a("f958"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},c33d:function(e,t,a){"use strict";var n=a("491e"),i=a.n(n);i.a},f958:function(e,t,a){"use strict";(function(e){a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("2909")),o=n(a("3835"));a("d3b7"),a("4de4"),a("99af"),a("caad"),a("2532");var s={data:function(){return{showLogin:!localStorage.getItem("username"),username:"tomcat",items:[]}},onLoad:function(){this.loadData()},methods:{handleRemove:function(t){var a=this,n=localStorage.getItem("username"),i=e.database().collection("user");wx.showLoading(),i.where({username:n}).get().then((function(e){var a,n=(0,o.default)(e.result.data,1),i=n[0],s=null!==(a=null===i||void 0===i?void 0:i.images)&&void 0!==a?a:[];return s.filter((function(e){return e!==t}))})).then((function(e){return i.where({username:n}).update({images:e})})).then((function(){a.loadData()})).finally((function(){wx.hideLoading()}))},loadData:function(){var t=this,a=localStorage.getItem("username"),n=e.database().collection("user");n.where({username:a}).get().then((function(e){var a,n=(0,o.default)(e.result.data,1),i=n[0];t.items=null!==(a=null===i||void 0===i?void 0:i.images)&&void 0!==a?a:[]}))},saveImage:function(t,a){var n=this,s=e.database().collection("user");s.where({username:t}).get().then((function(e){var t=(0,o.default)(e.result.data,1),a=t[0];return a.images})).then((function(e){return s.where({username:t}).update({images:[].concat((0,i.default)(e),[a])})})).then((function(){return n.loadData()})).finally((function(){wx.hideLoading()}))},handleUpload:function(){var t=this;uni.chooseImage({count:1,success:function(a){if(0!==a.tempFilePaths.length){var n=a.tempFiles[0];if(n.size>102400)alert("狗东西，这么大文件你要死啊？不能大于100kb");else{wx.showLoading();var i=a.tempFilePaths[0],o="/images/".concat(n.name);e.uploadFile({filePath:i,cloudPath:o,cloudPathAsRealPath:!0,onUploadProgress:function(e){Math.round(100*e.loaded/e.total)}}).then((function(e){var a=e.fileID,n=localStorage.getItem("username");t.saveImage(n,a)})).catch((function(e){e.message.includes("policy_does_not_allow_file_overwrite")&&alert("文件重名"),wx.hideLoading()}))}}}})},isExist:function(e){},login:function(e){localStorage.setItem("username",e),this.showLogin=!1,this.loadData()},register:function(e){this.login(e)},handleSubmit:function(){var e=this.username;this.isExist(e)?this.login(e):this.register(e)}}};t.default=s}).call(this,a("a9ff")["default"])}}]);